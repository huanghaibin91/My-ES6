<!DOCTYPE html>
<html lang="en">

<head>
    <title>generator</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <script>
        // generator生成器
        // generator函数是一个普通函数，特征：1.function关键字和函数名之间有一个星号，2.函数内部使用yield表达式
        // generator函数调用与普通函数一样，只是调用之后函数并不执行，返回的也不是函数运行结果。必须调用遍历器的next()方法
        // 每次调用next方法，内部指针就从函数头部或上一次停下来的地方开始执行，直达遇到下一个yield表达式（或return语句）
        // generator函数是分段执行的，yield表达式是暂停执行的标记，而next方法可以恢复执行

        function* helloWorldGenerator() {
            yield 'hello';
            yield 'world';
            return 'ending';
        }
        var hw = helloWorldGenerator();
        hw.next() // { value: 'hello', done: false }
        hw.next() // { value: 'world', done: false }
        hw.next() // { value: 'ending', done: true }
        hw.next() // { value: undefined, done: true }

        // 遍历器对象的next方法的运行逻辑：
        // （1）遇到yield表达式，就暂停执行后面的操作，并将紧跟在yield后面的那个表达式的值，作为返回的对象的value属性值
        // （2）下一次调用next方法时，再继续往下执行，直到遇到下一个yield表达式
        // （3）如果没有再遇到新的yield表达式，就一直运行到函数结束，直到return语句为止，并将return语句后面的表达式的值，作为返回的对象的value属性值
        // （4）如果该函数没有return语句，则返回的对象的value属性值为undefined

        var arr = [1, [[2, 3], 4], [5, 6]];
        var flat = function* (a) {
            var length = a.length;
            for (var i = 0; i < length; i++) {
                var item = a[i];
                if (typeof item !== 'number') {
                    yield* flat(item);
                } else {
                    yield item;
                }
            }
        };
        for (var f of flat(arr)) {
            console.log(f);   // 1, 2, 3, 4, 5, 6
        }

    </script>
</body>

</html>